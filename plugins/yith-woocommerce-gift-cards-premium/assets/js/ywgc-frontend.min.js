!function(t){function e(e){t("div.ywgc-card-amount span.amount").text(e)}function a(e){t("button.gift_card_add_to_cart_button").attr("disabled",!e)}function c(){var c=t(".gift-cards-list select");if(!t("#give-as-present").length){t(".gift-cards-list input.ywgc-manual-amount").addClass("ywgc-hidden"),t(".ywgc-manual-amount-error").remove();var i=0;if(0==c.length||"-1"==c.val()){var n=t(".gift-cards-list input.ywgc-manual-amount");if(n.length){var o=n.val();n.removeClass("ywgc-hidden");var r=new RegExp("^[1-9]\\d*(?:\\"+ywgc_data.currency_format_decimal_sep+"\\d{1,2})?$","g");o.length&&!r.test(o)?(n.after('<div class="ywgc-manual-amount-error">'+ywgc_data.manual_amount_wrong_format+"</div>"),a(!1)):o?(a(!0),(i=accounting.unformat(o,ywgc_data.mon_decimal_point))<=0?a(!1):(i=accounting.formatMoney(i,{symbol:ywgc_data.currency_format_symbol,decimal:ywgc_data.currency_format_decimal_sep,thousand:ywgc_data.currency_format_thousand_sep,precision:ywgc_data.currency_format_num_decimals,format:ywgc_data.currency_format}),a(!0))):a(!1)}}else c.val()?(a(!0),i=c.children("option:selected").data("wc-price")):a(!1);e(i)}}function i(){var e=t("div.ywgc-single-recipient").last(),a=ywgc_data.mandatory_email?"required":"",c='<div class="ywgc-single-recipient"><input type="email" name="ywgc-recipient-email[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.email+'" '+a+'/><input type="text" name="ywgc-recipient-name[]" class="yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+a+'/><a href="#" class="ywgc-remove-recipient">x</a> </div>';e.after(c),t("a.ywgc-remove-recipient").css("visibility","visible"),t("div.gift_card_template_button input[name='quantity']").css("display","none"),t("div.gift_card_template_button div.ywgc-multi-recipients").length||t("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}function n(){var e=t("div.ywgc-single-recipient").last(),a=ywgc_data.mandatory_email?"required":"",c='<div class="ywgc-single-recipient"><input type="text" name="ywgc-recipient-name[]" class="ywgc-recipient yith_wc_gift_card_input_recipient_details" placeholder="'+ywgc_data.name+'" '+a+'/><a href="#" class="ywgc-remove-recipient">x</a> </div>';e.after(c),t("a.ywgc-remove-recipient").css("visibility","visible"),t("div.gift_card_template_button input[name='quantity']").css("display","none"),t("div.gift_card_template_button div.ywgc-multi-recipients").length||t("div.gift_card_template_button div.quantity").after("<div class='ywgc-multi-recipients'><span>"+ywgc_data.multiple_recipient+"</span></div>")}function o(e){t(e).parent("div.ywgc-single-recipient").remove(),1==t('input[name="ywgc-recipient-email[]"').length&&(t("a.hide-if-alone").css("visibility","hidden"),t("div.gift_card_template_button input[name='quantity']").css("display",u),t("div.ywgc-multi-recipients").remove())}function r(e){t("div.ywgc-card-amount span.amount").html(e)}function d(e,a){var c=t(e).closest("div.ywgc-gift-card-content"),i=c.find("div.ywgc-gift-card-edit-details"),n=c.find("div.ywgc-gift-card-details");a?(i.removeClass("ywgc-hide"),i.addClass("ywgc-show"),n.removeClass("ywgc-show"),n.addClass("ywgc-hide")):(i.removeClass("ywgc-show"),i.addClass("ywgc-hide"),n.removeClass("ywgc-hide"),n.addClass("ywgc-show"))}function s(t){return new RegExp("^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$","i").test(t)}function g(){y(t("div.cart_totals")),t.ajax({url:w("get_cart_totals"),dataType:"html",success:function(e){t("div.cart_totals").replaceWith(e)}}),t(document.body).trigger("update_checkout")}function l(e,a,c){t.ajax({data:e,url:ywgc_data.ajax_url,type:"post",beforeSend:function(){t(a).html(c)},error:function(t){},success:function(e){t(a).html(e)}})}var u=t("div.gift_card_template_button input[name='quantity']").css("display"),p=function(){jQuery().prettyPhoto&&t('[rel="prettyPhoto[ywgc-choose-design]"]').prettyPhoto({hook:"rel",social_tools:!1,theme:"pp_woocommerce",default_width:"80%",default_height:"100%",horizontal_padding:20,opacity:.8,deeplinking:!1,keyboard_shortcuts:!0,allow_resize:!1,changepicturecallback:function(){t(document.body).trigger("ywgc_request_window_created")}})};t(document.body).on("ywgc_request_window_created",function(){t(".pp_content_container").css("position","fixed"),t(".pp_content_container").css("top","50%"),t(".pp_content_container").css("transform","translateY(-50%)"),t(".pp_content_container").css("max-width","80%"),t(".pp_content_container").css("max-height","100%"),t(".pp_content_container .pp_content").css("max-width","100%"),t(".pp_content_container .pp_content").css("max-height","600px"),t(".pp_content_container .pp_content").css("overflow-y","scroll")}),t(document).ready(function(){p(),t("div.ywgc-generator .datepicker").datepicker({dateFormat:"yy-mm-dd",minDate:1,maxDate:"+1Y"})});var m=function(){t('input[name="ywgc-as-present-enabled"]').length&&(t(".ywgc-generator").hide(),a(!1))};c(),m(),t(document).on("click",".pp_content_container .ywgc-choose-preset",function(e){var a=t(this).data("design-id"),c=t(this).data("design-url");t("#ywgc-main-image").attr("src",c),t(document).trigger("ywgc-picture-changed",["template",a]),t.prettyPhoto.close()}),t(document).on("click","a.ywgc-show-category",function(e){var a=t(this).data("category-id");return t("a.ywgc-show-category").removeClass("ywgc-category-selected"),t(this).addClass("ywgc-category-selected"),"all"!==a?(t(".ywgc-design-item").hide(),t(".ywgc-design-item."+a).show()):t(".ywgc-design-item").show(),!1}),t(document).on("ywgc-picture-changed",function(e,a,c){t("#ywgc-design-type").val(a),t("#ywgc-template-design").val(c)}),t(document).on("click","a.ywgc-show-giftcard",function(){return t(".ywgc-enter-code").slideToggle(400,function(){t(".ywgc-enter-code").find(":input:eq(0)").focus()}),!1}),t("button.ywgc-do-edit").css("display","inline"),t(document).on("input",".gift-cards-list input.ywgc-manual-amount",function(t){c()}),t(document).on("click","a.add-recipient",function(t){t.preventDefault(),i()}),t(document).on("click","a.add-physical-recipient",function(t){t.preventDefault(),n()}),t(document).on("click","a.ywgc-remove-recipient",function(e){e.preventDefault(),o(t(this))}),t(document).on("input","#ywgc-edit-message",function(e){t(".ywgc-card-message").html(t("#ywgc-edit-message").val())}),t(document).on("change",".gift-cards-list select",function(t){c()}),t(document).on("click","a.customize-gift-card",function(e){e.preventDefault(),t("div.summary.entry-summary").after('<div class="ywgc-customizer"></div>')}),t(document).on("click",".ywgc-default-picture",function(e){e.preventDefault();var a=t("#ywgc-upload-picture");a.replaceWith(a=a.clone(!0)),t(".ywgc-main-image img.ywgc-main-image").attr("src",ywgc_data.default_gift_card_image),t(".ywgc-main-image").css("background-color",""),t("div.gift-card-too-small").remove(),t(document).trigger("ywgc-picture-changed",["default"])}),t("body").on("click",".ywgc-product-picture",function(){if(t("body .single_variation_wrap input").hasClass("variation_id"))e=t("body .single_variation_wrap .variation_id").val();else var e=t(".single_add_to_cart_button").val();l({action:"yith_wc_gift_card_ajax_replace_for_product_image",product_id:e},"#yith_wc_gift_card_ajax_replace_for_product_image"),t(document).trigger("ywgc-picture-changed",["product_image"]),t("#ywgc-main-image").width()<t(".ywgc-main-image").width()?(t(".ywgc-main-image").css("background-color","#ffe326"),t(".ywgc-preview").prepend('<div class="gift-card-too-small">'+ywgc_data.notify_custom_image_small+"</div>")):t(".ywgc-main-image").css("background-color","")}),t(document).on("click",".ywgc-custom-picture",function(e){t("#ywgc-upload-picture").click()}),t("#ywgc-upload-picture").on("change",function(){t(".ywgc-picture-error").remove();var e=t(this).val().split(".").pop().toLowerCase();-1!=t.inArray(e,["gif","png","jpg","jpeg","bmp"])?t(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024?t("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):function(e){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){document.getElementById("ywgc-main-image").src=e.target.result,t(document).trigger("ywgc-picture-changed",["custom"]),t("#ywgc-main-image").width()<t(".ywgc-main-image").width()?(t(".ywgc-main-image").css("background-color","#ffe326"),t(".ywgc-preview").prepend('<div class="gift-card-too-small">'+ywgc_data.notify_custom_image_small+"</div>")):t(".ywgc-main-image").css("background-color","")}}(t(this)[0].files[0]):t("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>")}),t(document).on("click","#give-as-present",function(e){e.preventDefault(),t("#give-as-present").css("display","none"),t("div.ywgc-generator").append('<input type="hidden" name="ywgc-as-present" value="1">'),t(".woocommerce-variation-add-to-cart").length?t("div.ywgc-generator").insertBefore(t(".woocommerce-variation-add-to-cart ")):t("div.ywgc-generator").prependTo(t("form.cart")),t("button.single_add_to_cart_button").data("add-to-cart-text",t("button.single_add_to_cart_button").text()),t("button.single_add_to_cart_button").html(ywgc_data.add_gift_text),t("#ywgc-cancel-gift-card").css("display","inline-block"),t("div.ywgc-generator").css("display","block")}),t(document).on("click","#ywgc-cancel-gift-card",function(e){e.preventDefault(),t("div.ywgc-generator input[name='ywgc-as-present']").remove(),t("button.single_add_to_cart_button").html(t("button.single_add_to_cart_button").data("add-to-cart-text")),t("#give-as-present").css("display","inline-block"),t("#ywgc-cancel-gift-card").css("display","none"),t("div.ywgc-generator").css("display","none")}),t(document).on("change","#ywgc-postdated",function(e){t(this).is(":checked")?t("#ywgc-delivery-date").removeClass("ywgc-hidden"):t("#ywgc-delivery-date").addClass("ywgc-hidden")}),t(".variations_form.cart").on("found_variation",function(e,a){void 0!==a&&(t("#give-as-present").prop("disabled",!1),r(""!=a.price_html?t(a.price_html).html():t(".product-type-variable").find(".woocommerce-Price-amount.amount").first().html()))}),t(document).on("reset_data",function(){t("#give-as-present").prop("disabled",!0),r("")}),t(document).on("click","button.ywgc-apply-edit",function(e){var a=t(this),c=a.closest("div.ywgc-gift-card-content"),i=c.find('input[name="ywgc-edit-sender"]').val(),n=c.find('input[name="ywgc-edit-recipient"]').val(),o=c.find('textarea[name="ywgc-edit-message"]').val(),r=c.find('input[name="ywgc-item-id"]').val(),s=c.find('input[name="ywgc-gift-card-id"]'),g=s.val();if(a.hasClass("apply")){var l={action:"edit_gift_card",gift_card_id:g,item_id:r,sender:i,recipient:n,message:o};c.block({message:null,overlayCSS:{background:"#fff url("+ywgc_data.loader+") no-repeat center",opacity:.6}}),t.post(ywgc_data.ajax_url,l,function(t){t.code>0&&(c.find("span.ywgc-sender").text(i),c.find("span.ywgc-recipient").text(n),c.find("span.ywgc-message").text(o),2==t.code&&s.val(t.values.new_id)),c.unblock(),d(a,!1)})}}),t(document).on("click","button.ywgc-cancel-edit",function(e){d(t(this),!1)}),t(document).on("click","button.ywgc-do-edit",function(e){d(t(this),!0)}),t(document).on("click","form.gift-cards_form button.gift_card_add_to_cart_button",function(e){t("div.gift-card-content-editor.step-content p.ywgc-filling-error").remove(),t("#ywgc-postdated").is(":checked")&&!t.datepicker.parseDate("yy-mm-dd",t("#ywgc-delivery-date").val())&&(t("div.gift-card-content-editor.step-content").append('<p class="ywgc-filling-error">'+ywgc_data.missing_scheduled_date+"</p>"),e.preventDefault())}),t(document).on("click",".ywgc-gift-card-content a.edit-details",function(e){e.preventDefault(),t(this).addClass("ywgc-hide"),t("div.ywgc-gift-card-details").toggleClass("ywgc-hide")}),t('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(e,a){t(this).on("input",function(){t(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove()})}),t(document).on("submit",".gift-cards_form",function(e){var a=!0;t('.ywgc-single-recipient input[name="ywgc-recipient-email[]"]').each(function(e,c){t(this).val()&&!s(t(this).val())&&(t(this).closest(".ywgc-single-recipient").find(".ywgc-bad-email-format").remove(),t(this).after('<span class="ywgc-bad-email-format">'+ywgc_data.email_bad_format+"</span>"),a=!1)}),a||e.preventDefault()}),t(document).on("click","a.ywgc-remove-gift-card ",function(e){e.preventDefault();var a=t(e.currentTarget).parents("table"),c=t(e.currentTarget).data("gift-card-code");y(a);var i={security:ywgc_data.gift_card_nonce,code:c,action:"ywgc_remove_gift_card_code"};t.ajax({type:"POST",url:ywgc_data.ajax_url,data:i,dataType:"html",success:function(e){f(e),t(document.body).trigger("removed_gift_card"),_(a)},complete:function(){g()}})}),t("form.ywgc-enter-code").submit(function(e){e.preventDefault(),y(t(this));var a=t(this),c=a.find('input[name="gift_card_code"]'),i=c.val(),n={security:ywgc_data.gift_card_nonce,code:i,action:"ywgc_apply_gift_card_code"};t.ajax({type:"POST",url:ywgc_data.ajax_url,data:n,dataType:"html",success:function(e){f(e),t(document.body).trigger("applied_gift_card")},complete:function(){_(a),c.val(""),g()}})});var y=function(t){t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},_=function(t){t.removeClass("processing").unblock()},w=function(t){return ywgc_data.wc_ajax_url.toString().replace("%%endpoint%%",t)},f=function(e){t(".woocommerce-error, .woocommerce-message").remove(),t(ywgc_data.notice_target).before(e)};t(document).on("qv_loader_stop yit_quick_view_loaded flatsome_quickview",function(){c(),m()})}(jQuery);